<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pixel Jellyfish â€” Mining (Ore Erodes)</title>
  <style>
    :root{
      --cell: 12px;   /* pixel size */
      --gap:  2px;    /* pixel gap */
      --bg: #111;
      --body: #66ccff;
      --tent: #3399ff;
      --ore:  #7f8c8d;
      --ore2: #95a5a6;
      --axe:  #bfbfbf;   /* metal head */
      --wood: #8c5f3d;   /* handle */
      --spark:#ffd166;   /* debris / spark */
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); height:100vh;
      display:grid; place-items:center; image-rendering:pixelated;
      font-family:system-ui, sans-serif;
    }
    .scene{ display:flex; align-items:center; gap:18px; }

    /* --- Pixel grid helpers --- */
    .grid{ display:grid; gap:var(--gap); }
    .px{ width:var(--cell); height:var(--cell); background:transparent; }

    /* Jellyfish (5x6) */
    .jelly{ grid-template-columns:repeat(5,var(--cell)); grid-template-rows:repeat(6,var(--cell)); }
    .body{ background:var(--body); transition:background .2s steps(1); }
    .tent{ background:var(--tent); transition:background .2s steps(1); }

    /* Tool+Target area */
    .workbench{ display:flex; align-items:center; gap:12px; }

    /* Pickaxe frame grids (7x7) */
    .axe{ grid-template-columns:repeat(7,var(--cell)); grid-template-rows:repeat(7,var(--cell)); }
    .metal{ background:var(--axe); }
    .wood{  background:var(--wood); }

    /* Ore block (6x6) */
    .ore{ grid-template-columns:repeat(6,var(--cell)); grid-template-rows:repeat(6,var(--cell)); }
    .stone{ background:var(--ore); }
    .stone2{ background:var(--ore2); }
    .gone{ background:transparent !important; } /* mined-away tile */

    /* Debris (6x6 overlaid on ore) */
    .debris{ position:relative; }
    .bits{
      position:absolute; inset:0;
      display:grid; gap:var(--gap);
      grid-template-columns:repeat(6,var(--cell)); grid-template-rows:repeat(6,var(--cell));
      pointer-events:none;
    }
    .bit{ background:transparent; }
    .on{ background:var(--spark); } /* lit debris pixel */
  </style>
</head>
<body>
  <div class="scene">
    <!-- JELLYFISH -->
    <div class="grid jelly" id="jelly">
      <!-- Row 0 -->
      <div class="px"></div><div class="body"></div><div class="body"></div><div class="body"></div><div class="px"></div>
      <!-- Row 1 -->
      <div class="body"></div><div class="body"></div><div class="body"></div><div class="body"></div><div class="body"></div>
      <!-- Row 2 -->
      <div class="body"></div><div class="body"></div><div class="body"></div><div class="body"></div><div class="body"></div>
      <!-- Row 3 -->
      <div class="body"></div><div class="body"></div><div class="body"></div><div class="body"></div><div class="body"></div>
      <!-- Row 4 -->
      <div class="tent"></div><div class="tent"></div><div class="tent"></div><div class="tent"></div><div class="tent"></div>
      <!-- Row 5 -->
      <div class="tent"></div><div class="px"></div><div class="tent"></div><div class="px"></div><div class="tent"></div>
    </div>

    <!-- PICKAXE + ORE -->
    <div class="workbench">
      <!-- Pickaxe frames -->
      <div class="grid axe" id="axeF0">
        <!-- Frame 0: raised -->
        <!-- Row 0 --> <div class="px"></div><div class="px"></div><div class="metal"></div><div class="metal"></div><div class="metal"></div><div class="px"></div><div class="px"></div>
        <!-- Row 1 --> <div class="px"></div><div class="metal"></div><div class="metal"></div><div class="metal"></div><div class="metal"></div><div class="metal"></div><div class="px"></div>
        <!-- Row 2 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 3 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 4 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 5 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 6 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="px"></div><div class="px"></div><div class="px"></div>
      </div>

      <div class="grid axe" id="axeF1" style="display:none">
        <!-- Frame 1: mid swing -->
        <!-- Row 0 --> <div class="px"></div><div class="px"></div><div class="metal"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 1 --> <div class="px"></div><div class="metal"></div><div class="metal"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 2 --> <div class="px"></div><div class="px"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 3 --> <div class="px"></div><div class="px"></div><div class="wood"></div><div class="wood"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 4 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="wood"></div><div class="px"></div><div class="px"></div>
        <!-- Row 5 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="wood"></div><div class="px"></div>
        <!-- Row 6 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="px"></div><div class="px"></div>
      </div>

      <div class="grid axe" id="axeF2" style="display:none">
        <!-- Frame 2: impact -->
        <!-- Row 0 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 1 --> <div class="px"></div><div class="px"></div><div class="metal"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 2 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="metal"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 3 --> <div class="px"></div><div class="px"></div><div class="wood"></div><div class="wood"></div><div class="px"></div><div class="px"></div><div class="px"></div>
        <!-- Row 4 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="wood"></div><div class="px"></div><div class="px"></div>
        <!-- Row 5 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="wood"></div><div class="px"></div>
        <!-- Row 6 --> <div class="px"></div><div class="px"></div><div class="px"></div><div class="px"></div><div class="wood"></div><div class="px"></div><div class="px"></div>
      </div>

      <!-- Ore block (with debris overlay) -->
      <div class="debris">
        <div class="grid ore" id="ore">
          <!-- initial alternating pattern -->
          <!-- Row 0 --> <div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div>
          <!-- Row 1 --> <div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div>
          <!-- Row 2 --> <div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div>
          <!-- Row 3 --> <div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div>
          <!-- Row 4 --> <div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div>
          <!-- Row 5 --> <div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div><div class="stone2"></div><div class="stone"></div>
        </div>

        <!-- Debris grid overlay -->
        <div class="bits" id="bits">
          <!-- 6x6 invisible pixels -->
          <!-- Row 0 -->
          <div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div>
          <!-- Row 1 -->
          <div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div>
          <!-- Row 2 -->
          <div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div>
          <!-- Row 3 -->
          <div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div>
          <!-- Row 4 -->
          <div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div>
          <!-- Row 5 -->
          <div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div><div class="bit"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* -------------------- Jelly: tentacle sway -------------------- */
    const tentacles = document.querySelectorAll('.tent');
    let tentToggle = false;
    setInterval(() => {
      tentacles.forEach((t, i) => {
        t.style.background = ((i + (tentToggle?1:0)) % 2 === 0) ? 'var(--tent)' : 'transparent';
      });
      tentToggle = !tentToggle;
    }, 500);

    /* -------------------- Pickaxe frames -------------------- */
    const axeFrames = [
      document.getElementById('axeF0'),
      document.getElementById('axeF1'),
      document.getElementById('axeF2')
    ];
    const swingOrder = [0,1,2,1]; // 2 = impact

    /* -------------------- Debris + Ore erosion -------------------- */
    const bits = Array.from(document.querySelectorAll('#bits .bit'));
    const oreTiles = Array.from(document.querySelectorAll('#ore > div'));
    const BW = 6, BH = 6;
    const bidx = (r,c) => r*BW + c;
    const tIdx = (r,c) => r*BW + c;

    // Debris frames (visual pop)
    const debrisFrames = [
      [ bidx(2,0), bidx(3,1) ],
      [ bidx(1,0), bidx(2,1), bidx(3,2) ],
      [ bidx(0,0), bidx(1,1), bidx(2,2), bidx(3,3) ],
      [ bidx(0,1), bidx(1,2), bidx(2,3) ],
      [ bidx(0,2) ]
    ];

    // Erosion order (gradually remove from the LEFT edge where the axe hits)
    // Left-to-right, top-to-bottom:
    const erosionOrder = [];
    for (let c=0; c<BW; c++){
      for (let r=0; r<BH; r++){
        erosionOrder.push(tIdx(r,c));
      }
    }
    let erosionPtr = 0;

    function clearDebris(){
      bits.forEach(b => b.classList.remove('on'));
    }
    function popDebris(step){
      clearDebris();
      (debrisFrames[step] || []).forEach(i => bits[i]?.classList.add('on'));
    }

    // Remove N ore tiles per impact, following erosionOrder.
    function erodeOre(n=3){
      let removed = 0;
      while (removed < n && erosionPtr < erosionOrder.length){
        const k = erosionOrder[erosionPtr++];
        const tile = oreTiles[k];
        if (!tile) break;
        tile.classList.add('gone'); // transparent
        removed++;
      }
      // If fully mined, respawn after a short pause
      if (erosionPtr >= erosionOrder.length){
        setTimeout(respawnOre, 400);
      }
    }

    function respawnOre(){
      // Restore the checker pattern
      oreTiles.forEach((tile, i) => {
        tile.className = ''; // remove all
        // reapply alternating look
        const r = Math.floor(i / BW), c = i % BW;
        tile.classList.add(((r + c) % 2 === 0) ? 'stone' : 'stone2');
      });
      erosionPtr = 0;
      clearDebris();
    }

    /* -------------------- Main loop -------------------- */
    let frame = 0;
    setInterval(() => {
      // Toggle axe frames
      const f = swingOrder[frame % swingOrder.length];
      axeFrames.forEach((el,i)=> el.style.display = (f===i)?'grid':'none');

      const impact = (f === 2);

      // Debris & erosion on impact
      if (impact){
        const step = (Math.floor(frame/1)) % debrisFrames.length;
        popDebris(step);
        erodeOre(3); // remove 3 tiles each hit (tweak to taste)
      } else {
        clearDebris();
      }

      frame++;
    }, 180);
  </script>
</body>
</html>
